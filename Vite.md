Vite — это инструмент сборки (бандлер) нового поколения. Он состоит из двух частей:
1. Сервер разработки, который поддерживает ES модули
2. Команда сборки, которая собирает сверхоптимизированный код с помощью Rollup

Vite готов к использованию из коробки, но расширяется с помощью Plugin API и JavaScript API

# Отличия

Традиционный бандлер Webpack берёт все ассеты (JS модули, CSS, HTML), прогоняет их через указанные инструменты (TS transpiler, babel) и генерирует унифицированные файлы:

![](webpack-1.png 2023-06-09 at 17.30.01.png>)

Проблема в том, что этот процесс повторяется при каждом изменении и с ростом проекта требует всё больше времени. К примеру, так работает `create-react-app`, который использует Webpack под капотом.

Vite вместо этого использует ES modules, которые поддерживают современные браузеры:
```html
<script type="module" scr="main.js"></script>

<script type="module">
	/* Javascript module code here */
</script>
```

Все теги `script` указаны с атрибутом `type="module"`, что позволяет доставлять в браузер код в виде отдельных файлов вместо унифицированного файла aka `bundle.js`.

Итак, для сборки Vite использует отдельный проект Rollup.

После сборки Webpack работает так:
![](webpack-2.png 2023-06-09 at 17.36.54.png>)

А Vite работает так:
![](vite-1.png 2023-06-09 at 17.37.54.png>)

# Структура файлов
После инициализации Vite в помощью `npm create vite@latest app-name` или `yarn create vite@latest app-name` и выбора параметров, в папке проекта появляются следующие файлы:

## src/index.html
Это главная страница сайта. Обрати внимание, что она находится в директории `src`, а не `public`, так как последняя предназначена для статических файлов. Директория `src` предназначена для кода, которым и является этот файл.

Самая главная часть находится вот тут:

```html
<div id="app"></div>
<script type="module" src="/src/main.js"></script>
```

Это DOM-элемент для входа приложения и элементы скрипта с кодом. Аттрибут `type` указывает, что мы используем модуль JavaScript вместо "классического скрипта" (Подробнее на [MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script))

Указанный main.js (или .jsx) — это точка входа в приложение. В нём мы импортируем и монтируем приложение.

## package.json

Фреймворк тут будет указан в зависимостях, а сам Vite — в дев-зависимостях вместе с его плагином для фреймворка.

Скрипт `dev` содержит команду `vite`, который запускает сервер для разработки.
Скрипт `build` содержит команду `vite build`, который собирает проект для продакшна.
Также есть команда `vite preview`, которая собирает проект и поднимает для него сервер — чтобы проверить продакшн-сборку.

## vite.config.js

Файл конфигурации Vite, в котором можно менять настройки:
- добавлять плагины
- менять порты
- добавлять прокси и пр.

Все параметры указываются в объекте, который передаётся в качестве аргумента функции defineConfig:

```js
import { defineConfig } from 'vite';
export default defineConfig({
	plugins: [react()],
	server: {
		port: 3000,
	},
});
```

# Переменные окружения

Vite поддерживает переменные окружения в файле `.env`, размещённом в корне проекта. Важное отличие состоит в том, что имена переменных должны начинаться с VITE_:

```sh
VITE_API_KEY=123456789
```

Внутри проектов они используются через объект `import.meta.env`:

```jsx
const Header = () => {
	return <div>{import.meta.env.VITE_API_KEY}</div>; }; export default Header;
```

# Работа с CSS

## SASS
Vite поддерживает Sass, но для этого его нужно установить в проект: `npm i sass`. После этого мы можем указывать `<style lang="sass">` или импортировать файл со стилями:

```js
import './styles/main.scss';
```

## PostCSS
Для поддержки PostCSS достаточно иметь в проекте файл с конфигурацией PostCSS, поддерживаемый postcss-load-config (например, postcss.config.js).

## Модули CSS
Поддержка модулей CSS включается автоматически при наличии файлов с .module.css в конце имени файла.

# Плагины

Vite поддерживает [многие технологии](https://vitejs.dev/guide/features.html) из коробки. В случае необходимости какого-то решения стоит пойти следующим путём:
1. Поискать нужное решения среди встроенных возможностей [тут](https://vitejs.dev/guide/features.html)
2. Потому проверить список [официальных плагинов](https://vitejs.dev/plugins/)
3. Далее можно посмотреть список [плагинов сообщества](https://github.com/vitejs/awesome-vite#plugins)

# Внешние ресурсы
Документация — [сайт](https://vitejs.dev)
Туториал — [видео](https://www.youtube.com/watch?v=89NJdbYTgJ8)
Туториал — [статья](https://www.traversymedia.com/blog/vite-crash-course)
